<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fund Request Form</title>
    <style>
        /* General styles */
body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
    margin: 0;
    padding: 0;
    
} 
header {
            background-color: #003366; /* KCAU's branding color */
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header .logo img {
            height: 40px;
        }

        header nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
/* Navigation Bar */
.top-nav {
      background-color: #737a81;
      color: white;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    .top-nav .logo {
      font-size: 24px;
      font-weight: bold;
    }
    .top-nav nav {
      display: flex;
      gap: 20px;
    }
    .top-nav nav a {
      text-decoration: none;
      color: white;
      font-weight: bold;
    }
    .top-nav nav a:hover {
      text-decoration: underline;
    }

/* Container to hold all content */
.container {
    width: 95%;
    max-width: 600px;
    margin: 20px auto;
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
/* Prevent horizontal scrolling */
body {
    margin: 0;
    overflow-x: hidden;
}

/* Optional: Make sure main containers do not overflow */
.container, .content {
    max-width: 100%;
    overflow-x: hidden;
    box-sizing: border-box;
}

/* Heading style */
h1 {
    text-align: center;
    color: #333;
}
.left-offset {
    margin-left: 1cm; /* or use padding-left if preferred */
}

/* Form elements styles */
select, input, button {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    border-radius: 5px;
    border: 1px solid #ddd;
}

/* Button specific styles */
button {
    cursor: pointer;
    border: none;
}

/* Custom buttons */
.add-model-button {
    background-color: #FFC300;
    color: #333;
}

.remove-button {
    background-color: #B22222;
    color: white;
    width: 2cm;
    height: 1cm;
    border: none;
    text-align: center;
    display: inline-block;
}

/* Cart-item style */
.cart-item {
    padding: 10px;
    border: 1px solid #ddd;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Hidden class for elements */
.hidden {
    display: none;
}

/* Total display style */
.total-display {
    font-size: 18px;
    font-weight: bold;
    margin-top: 15px;
}

/* Table styles */
table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 10px;
}

th, td {
    border: 1px solid #ddd;
    padding: 5px;
    text-align: left;
}

th {
    background-color: #f2f2f2;
}

/* Subcategory container styles */
.subcategory-container {
    border: 1px solid #ddd;
    padding: 10px;
    margin-top: 10px;
    border-radius: 5px;
    background-color: #f9f9f9;
    position: relative;
}

/* Subcategory header styles */
.subcategory-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Button styles for proceed and send receipt */
#proceedButton, #sendReceiptButton {
    background-color: green;
    color: white;
    font-weight: bold;
    margin-top: 20px;
    display: none;
}

/* Responsive design - Media Queries */
@media (max-width: 768px) {
    body {
        font-size: 14px;
    }

    /* Adjust the container width */
    .container {
        width: 100%;
        padding: 15px;
    }

    /* Adjust input and button width for small screens */
    select, input, button {
        width: 100%;
        padding: 12px;
    }

    /* Make the buttons and input fields larger for ease of use on mobile */
    .add-model-button, .remove-button, #proceedButton, #sendReceiptButton {
        padding: 15px;
    }

    /* Adjust table padding for small screens */
    th, td {
        font-size: 12px;
        padding: 8px;
    }

    /* Hide the subcategory container header buttons in smaller screens */
    .subcategory-header button {
        width: 50px;
        height: 50px;
    }
}

@media (max-width: 480px) {
    /* Adjust font size for very small screens */
    body {
        font-size: 12px;
    }

    /* Stack buttons and inputs for small screens */
    select, input, button {
        width: 100%;
        padding: 10px;
    }

    .remove-button {
        font-size: 14px;
        padding: 8px;
    }

    /* Adjust the size of the remove button */
    .remove-button {
        width: 1.5cm;
        height: 1cm;
    }

    /* Reduce the size of subcategory container */
    .subcategory-container {
        padding: 8px;
    }#spinner {
  display: none;
  border: 4px solid #422e62; /* Light gray background */
  border-top: 4px solid #b0a316; /* Blue color for the spinner */
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 2s linear infinite;
  margin: 20px auto;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}




}footer {
      background-color: #004080;
      color: white;
      text-align: center;
      padding: 20px 10px;
      margin-top: 40px;
    }
    footer p {
      margin: 5px 0;
    }
    footer a {
      color: #00aaff;
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }/* Remove button styling */
.remove-attachment {
  @apply text-red-600 hover:text-red-700 bg-white rounded-full p-1 transition-all;
}

/* Camera modal styling */
.camera-modal {
  @apply fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50;
}

.camera-content {
  @apply bg-white p-6 rounded-lg w-full max-w-2xl;
}

/* Reconciliation editor styling */
.reconcile-editor {
  @apply border rounded-lg p-4 bg-white shadow-lg;
}

.reconcile-textarea {
  @apply w-full p-3 border rounded mb-4 focus:ring-2 focus:ring-blue-500 focus:border-transparent;
  min-height: 200px;
}/* Group the buttons in a flex row with 2cm spacing */
.button-group {
    display: flex;
    flex-direction: row;
    gap: 2cm; /* this creates horizontal spacing */
    margin-top: 1rem;
    justify-content: center; /* optional: centers buttons horizontally */
    flex-wrap: wrap; /* allows wrapping on small screens */
}

/* Button styling */
#uploadButton, #photoButton, #reconcileButton {
    background-color: #1a263e;
    color: white;
    width: 2cm;
    height: 1cm;
    border: none;
    text-align: center;
    display: inline-block;
}

/* Hover effect */
#uploadButton:hover, #photoButton:hover, #reconcileButton:hover {
    background-color: #1e40af;
}




    </style>
</head>
<body><!-- Header Section -->
    <header>
        <div class="logo">
            <img src="logo.png" alt="KCAU Logo">
        </div>
        <nav>
            <ul>
                
                
            </ul>
        </nav>
    </header> <!-- Navigation Bar -->
    <div class="top-nav">
      <div class="log"></div>
      <nav>
        <a href="home.html">Home</a>
        <a href="view.html">Downloads</a>
        <a href="receipts.html">Receipts</a>
        
      </nav>
    </div><div class="right-offset">
        <!-- all your content here -->
    </div>
    
</div>

    <h1>Fund Request</h1>

    <label for="requestType">Request Type:</label>
    <select id="requestType">
        <option value="New">New</option>
        <option value="Reimbursement">Reimbursement</option>
    </select> <!-- Reimbursement Section -->
    <div id="reimbursementButtons" class="hidden space-y-4">
      <div id="attachmentsContainer" class="space-y-2"></div>
      <div class="flex gap-2">
        <button
          id="uploadButton"
          class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
        >
          Upload
        </button>
        <button
          id="photoButton"
          class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
        >
          Photo
        </button>
        <button
          id="reconcileButton"
          class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
        >
          Reconcile
        </button>
      </div>
    </div>
   
    <label for="category">Category:</label>
    <select id="category">
        <option value="" disabled selected>Select category</option>
        <option value="Fuel">Fuel</option>
        <option value="Borehole Expenses">Borehole Expenses</option>
        <option value="Construction">Construction</option>
        <option value="Parts/Supplies">Parts/Supplies</option>
        <option value="Permits">Permits</option>
        <option value="Internet/Electricity">Internet/Electricity</option>
        <option value="Rent">Rent</option>
        <option value="Vehicle Repair">Vehicle Repair</option>
        <option value="Expeditions">Expeditions</option>
        <option value="Transport">Transport</option>
        <option value="Meals">Meals</option>
        <option value="Accommodations">Accommodations</option>
        <option value="Projects">Projects</option>
        <option value="Vehicle Service">Vehicle Service</option>
        <option value="Other">Other</option>
    </select>

    <label for="subCategory">Sub-category:</label>
    <select id="subCategory">
        <option value="None">None</option>
    </select>
    <input type="text" id="otherSubCategory" class="hidden" placeholder="Specify Other Sub-category">

    <button class="add-model-button" onclick="addModel()">Add sub-category</button>

    <div class="models"></div>
    <div id="summary" class="hidden"></div>
    <button id="proceedButton" onclick="proceed()">Proceed</button> <!-- Transaction Cost input (optional) -->
    <div id="transactionCostContainer" style="margin-top: 20px;">
        <label for="transactionCost">Transaction Cost (Optional):</label>
        <input type="number" id="transactionCost" name="transactionCost" placeholder="Enter transaction cost" />
    </div> <!-- Space for Total Request -->
    <div id="totalRequestContainer" style="margin-top: 20px;">
        <label for="totalRequest">Total Request:</label>
        <input type="text" id="totalRequest" name="totalRequest" readonly />
    </div>
    <!-- Send and Download Receipt Button -->
  <button id="sendReceiptButton" onclick="sendAndDownloadReceipt()">Send and Download Receipt</button>

  <!-- Spinner (Initially hidden) -->
  <div id="spinner"></div>

  <!-- Feedback Message (Initially hidden) -->
  <div id="feedback" style="display: none;"></div>
</div>
<!-- Add a container for the reconciliation letter -->
<div id="reconcileContainer"></div>

<script>
    // Handle category change and populate sub-categories
    document.getElementById('category').addEventListener('change', function () {
        const subCategory = document.getElementById('subCategory');
        subCategory.innerHTML = "";

        const selectedCategory = this.value;

        const subCategories = {
    "Fuel": ["Other"],
    "Borehole Expenses": [ "Drilling Permits", "Surveying", "Pump Installation", "Water Testing", "Casing Pipes", "Grouting", "Other"],
    "Construction": ["Cement", "Sand", "Gravel", "Bricks", "Iron Sheets", "Nails", "Timber", "Other"],
    "Parts/Supplies": [ "Rods", "Centralizers", "Rubber", "Casings", "Drill Bits", "Mud Pumps", "Water Hoses", "Filters", "Bearings", "Grease", "Other"],
    "Permits": [ "Other"],
    "Internet/Electricity": [ "Other"],
    "Rent": [ "Other"],
    "Vehicle Repair": [ "Tires", "Battery", "Oil Change", "Brake Pads", "Suspension", "Other"],
    "Expeditions": [ "Other"],
    "Transport": [ "Other"],
    "Meals": ["Other"],
    "Accommodations": [ "Other"],
    "Projects": [ "Other"],
    "Vehicle Service": [ "Other"],
    "Other": [ "Other"]
};


        // Always start with "None"
        const options = ["None"];

        if (subCategories[selectedCategory]) {
            options.push(...subCategories[selectedCategory]);
        } else {
            options.push("Other"); // Fallback if category not found
        }

        // Populate dropdown
        options.forEach(option => {
            const opt = document.createElement("option");
            opt.value = option;
            opt.textContent = option;
            subCategory.appendChild(opt);
        });
    });

    // Show/hide reimbursement buttons
    document.getElementById('requestType').addEventListener('change', function () {
        const reimbursementButtons = document.getElementById('reimbursementButtons');
        this.value === "Reimbursement"
            ? reimbursementButtons.classList.remove('hidden')
            : reimbursementButtons.classList.add('hidden');
    });

    // Show "Other" input field if "Other" is selected
    document.getElementById('subCategory').addEventListener('change', function () {
        const otherInput = document.getElementById("otherSubCategory");
        this.value === "Other"
            ? otherInput.classList.remove("hidden")
            : otherInput.classList.add("hidden");
    });


    function addModel() {
    const reqType = document.getElementById('requestType');
    const category = document.getElementById('category');
    const subCategory = document.getElementById('subCategory');
    const otherSubCategoryInput = document.getElementById("otherSubCategory");

    let selectedModel = subCategory.value;

   

    if (selectedModel === "Other") {
        selectedModel = otherSubCategoryInput.value.trim();
        if (!selectedModel) {
            alert("Please enter a sub-category name.");
            return;
        }
    }

    // Lock the dropdowns after first sub-category is added
    reqType.disabled = true;
    category.disabled = true;

    const modelContainer = document.createElement('div');
    modelContainer.className = 'subcategory-container';
    modelContainer.innerHTML = `
        <div class="subcategory-header">
            <h2>${selectedModel}</h2>
            <button class="remove-button" onclick="removeSubCategory(this)">Remove</button>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Amount</th>
                    <th>Quantity</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" placeholder="Description"></td>
                    <td><input type="number" class="amount" placeholder="Amount"></td>
                    <td><input type="number" class="quantity" placeholder="Quantity"></td>
                </tr>
            </tbody>
        </table>
    `;
    document.querySelector('.models').appendChild(modelContainer);

    // Reset and hide the "Other" input field
    otherSubCategoryInput.value = "";
    otherSubCategoryInput.classList.add("hidden");
}
document
        .getElementById("uploadButton")
        .addEventListener("click", function () {
          const fileInput = document.createElement("input");
          fileInput.type = "file";

          fileInput.click();

          fileInput.addEventListener("change", function () {
            const file = fileInput.files[0];
            if (file) {
              const attachmentItem = document.createElement("div");
              attachmentItem.className = "attachment-item";

              // Create preview element
              const previewDiv = document.createElement("div");
              previewDiv.className = "attachment-preview";

              // Add appropriate icon or preview
              if (file.type.startsWith("image/")) {
                const reader = new FileReader();
                reader.onload = function (e) {
                  const img = document.createElement("img");
                  img.src = e.target.result;
                  img.alt = file.name;
                  previewDiv.appendChild(img);
                };
                reader.readAsDataURL(file);
              } else {
                previewDiv.innerHTML = "📄"; // Document icon
              }

              // File info and remove button
              attachmentItem.innerHTML = `
                <div class="file-info">
                    ${previewDiv.outerHTML}
                    <span class="file-name">${file.name}</span>
                </div>
                <button onclick="this.parentElement.parentElement.remove()" 
                            class="text-red-600 hover:text-red-700 mt-2">
                        ✕ Remove
                    </button>
                <input type="hidden" name="attachments[]" value="${file.name}">
            `;

              // Add to attachments container
              document
                .getElementById("attachmentsContainer")
                .appendChild(attachmentItem);
              saveUploadedFile(file);
            }
          });
        });
      // Photo Capture Modal
      document
        .getElementById("photoButton")
        .addEventListener("click", function () {
          // Create modal overlay
          const modal = document.createElement("div");
          modal.className =
            "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50";

          // Camera container
          const cameraContainer = document.createElement("div");
          cameraContainer.className =
            "bg-white rounded-lg p-6 w-full max-w-2xl";
          cameraContainer.innerHTML = `
        <h4 class="text-xl font-semibold mb-4">Take Photo</h4>
        <div class="video-preview bg-black aspect-video"></div>
        <div class="flex gap-2 mt-4 justify-end">
            <button class="cancel-btn px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600">
                Cancel
            </button>
            <button class="capture-btn px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                Capture
            </button>
        </div>
    `;

          modal.appendChild(cameraContainer);
          document.body.appendChild(modal);

          navigator.mediaDevices
            .getUserMedia({ video: true })
            .then(function (stream) {
              const video = document.createElement("video");
              video.className = "w-full h-full object-contain";
              video.srcObject = stream;
              video.play();

              cameraContainer
                .querySelector(".video-preview")
                .appendChild(video);

              // Capture handler
              cameraContainer
                .querySelector(".capture-btn")
                .addEventListener("click", function () {
                  const canvas = document.createElement("canvas");
                  const context = canvas.getContext("2d");
                  canvas.width = video.videoWidth;
                  canvas.height = video.videoHeight;
                  context.drawImage(video, 0, 0, canvas.width, canvas.height);

                  const photoDataUrl = canvas.toDataURL("image/png");

                  // Create attachment item
                  const attachmentItem = document.createElement("div");
                  attachmentItem.className =
                    "flex items-center gap-4 bg-gray-50 p-3 rounded mb-2";
                  attachmentItem.innerHTML = `
                <img src="${photoDataUrl}" class="w-32 h-32 object-cover rounded">
                <div class="flex-1">
                    <p class="font-medium">Captured Photo</p>
                    <button onclick="this.parentElement.parentElement.remove()" 
                            class="text-red-600 hover:text-red-700 mt-2">
                        ✕ Remove
                    </button>
                </div>
                <input type="hidden" name="attachments[]" value="${photoDataUrl}">
            `;

                  document
                    .getElementById("attachmentsContainer")
                    .appendChild(attachmentItem);

                  // Cleanup
                  stream.getTracks().forEach((track) => track.stop());
                  modal.remove();
                });

              // Cancel handler
              cameraContainer
                .querySelector(".cancel-btn")
                .addEventListener("click", function () {
                  stream.getTracks().forEach((track) => track.stop());
                  modal.remove();
                });
            })
            .catch(function (error) {
              console.error("Camera error:", error);
              modal.remove();
              alert("Could not access camera. Please check permissions.");
            });
        });

      // Styled Reconciliation Editor
      document
        .getElementById("reconcileButton")
        .addEventListener("click", function () {
          // Create modal overlay
          const modal = document.createElement("div");
          modal.className =
            "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50";

          // Reconciliation container
          const editor = document.createElement("div");
          editor.className = "bg-white rounded-lg p-6 w-full max-w-3xl";
          editor.innerHTML = `
        <h3 class="text-xl font-semibold mb-4">Reconciliation Letter</h3>
        <textarea 
            class="w-full p-4 border rounded-lg mb-4 min-h-[300px] focus:ring-2 focus:ring-blue-500"
            placeholder="Write your reconciliation letter here..."
        ></textarea>
        <div class="flex gap-2 justify-end">
            <button class="cancel-btn px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600">
                Cancel
            </button>
            <button class="save-btn px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                Save Letter
            </button>
        </div>
    `;

          modal.appendChild(editor);
          document.body.appendChild(modal);

          // Save handler
          editor
            .querySelector(".save-btn")
            .addEventListener("click", function () {
              const letterContent = editor
                .querySelector("textarea")
                .value.trim();
              if (letterContent) {
                const attachmentItem = document.createElement("div");
                attachmentItem.className =
                  "flex items-center gap-4 bg-gray-50 p-3 rounded mb-2";
                attachmentItem.innerHTML = `
                <div class="w-16 h-16 bg-purple-100 rounded flex items-center justify-center">
                    📝
                </div>
                <div class="flex-1">
                    <p class="font-medium">Reconciliation Letter</p>
                    <p class="text-sm text-gray-600">${letterContent.substring(
                      0,
                      50
                    )}...</p>
                    <button onclick="this.parentElement.parentElement.remove()" 
                            class="text-red-600 hover:text-red-700 mt-2">
                        ✕ Remove
                    </button>
                </div>
                <input type="hidden" name="reconciliation_letter" value="${encodeURIComponent(
                  letterContent
                )}">
            `;

                document
                  .getElementById("attachmentsContainer")
                  .appendChild(attachmentItem);
                modal.remove();
              } else {
                alert("Please write something in the letter.");
              }
            });

          // Cancel handler
          editor
            .querySelector(".cancel-btn")
            .addEventListener("click", function () {
              modal.remove();
            });
        });

      /* // Add authentication check
      document.addEventListener("DOMContentLoaded", function () {
        if (!localStorage.getItem("authToken")) {
          alert("Please sign in first");
          window.location.href = "sign.html";
        }
      }); */
      function createAttachmentElement(content, type) {
        const div = document.createElement("div");
        div.className =
          "p-3 border rounded bg-gray-50 flex items-center justify-between";

        if (type === "photo") {
          div.innerHTML = `
                    <div class="flex items-center gap-2">
                        <img src="${content}" class="h-12 w-12 object-cover">
                        <span>Photo</span>
                    </div>
                    <button onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-700">✕</button>
                `;
        } else if (type === "file") {
          div.innerHTML = `
                    <div class="flex items-center gap-2">
                        <span class="text-2xl"></span>
                        <span>${content.name}</span>
                    </div>
                    <button onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-700">✕</button>
                `;
        } else if (type === "reconciliation") {
          div.innerHTML = `
                    <div class="flex items-center gap-2">
                        <span class="text-2xl"></span>
                        <div>
                            <p class="font-medium">Reconciliation Letter</p>
                            <p class="text-sm text-gray-600">${content.substring(
                              0,
                              50
                            )}...</p>
                        </div>
                    </div>
                    <button onclick="this.parentElement.remove()" class="text-red-600 hover:text-red-700">✕</button>
                `;
        }
        return div;
      }
    function removeSubCategory(button) {
        button.closest('.subcategory-container').remove();
    }
    document.getElementById("proceedButton").style.display = "block";
    function proceed() {
    // Get the user's locale (this will return the language/country code like 'en-US', 'en-KE', etc.)
    const userLocale = navigator.language || 'en-US'; // Default to 'en-US' if locale is not found
    
    // Get the currency code based on the user's locale
    const currencyCode = getCurrencyCode(userLocale);
    
    // Use the user's locale and their currency
    const formatter = new Intl.NumberFormat(userLocale, { 
        style: 'currency', 
        currency: currencyCode || 'USD' // Default to 'USD' if currency code is empty
    });

    let total = 0;
    let summaryHTML = `<h3>Summary</h3>
        <p><strong>Request Type:</strong> ${document.getElementById("requestType").value}</p>
        <p><strong>Category:</strong> ${document.getElementById("category").value}</p>`;

    // Loop through all subcategories
    document.querySelectorAll(".subcategory-container").forEach(box => {
        let name = box.querySelector("h2").innerText;
        let desc = box.querySelector("input[type='text']").value;
        let amount = parseFloat(box.querySelector(".amount").value) || 0;
        let qty = parseInt(box.querySelector(".quantity").value) || 1;
        let subtotal = amount * qty;
        total += subtotal;

        // Add each item's info to the summary HTML
        summaryHTML += `
            <div><strong>${name}</strong><br>
            Description: ${desc}<br>
            Amount: ${formatter.format(amount)} x Quantity: ${qty} = ${formatter.format(subtotal)}</div><hr>`;
    });
    // Display the total
    summaryHTML += `<p class="total-display">Total Amount: ${formatter.format(total)}</p>`;
    
    // Show the summary and the proceed button
    document.getElementById("summary").innerHTML = summaryHTML;
    document.getElementById("summary").classList.remove("hidden");
    document.getElementById("sendReceiptButton").style.display = "block";
}

// This function returns the currency code based on the user's locale
function getCurrencyCode(locale) {
    // Example of mapping some locales to their respective currency codes
    const currencyMap = {
        'en-US': 'USD',   // United States Dollar (USA)
        'en-KE': 'KES',   // Kenyan Shilling (Kenya)
        'en-TZ': 'TZS',   // Tanzanian Shilling (Tanzania)
        'en-UG': 'UGX',   // Ugandan Shilling (Uganda)
        'en-ZM': 'ZMW',   // Zambian Kwacha (Zambia)
        'en-GH': 'GHS',   // Ghanaian Cedi (Ghana)
        // Add more mappings as necessary
    };

    // Default to USD if locale is not recognized
    return currencyMap[locale] || 'USD';
} function sendAndDownloadReceipt() {
      // Show spinner and hide the button
      document.getElementById("sendReceiptButton").style.display = "none";
      document.getElementById("spinner").style.display = "block"; // Show the spinner
  
      // Simulate sending data (you can replace this with a real API call or data sending process)
      setTimeout(function() {
        // Simulate success or failure (you can replace this with actual success or failure logic)
        const isSuccess = Math.random() > 0.5; // Random success or failure
  
        // Hide spinner and show feedback message
        document.getElementById("spinner").style.display = "none";
        document.getElementById("sendReceiptButton").style.display = "block"; // Show button again
        
        const feedbackMessage = isSuccess ? "Request successfully sent" : "Request failed";
        document.getElementById("feedback").innerText = feedbackMessage;
        document.getElementById("feedback").style.display = "block"; // Show feedback message
  
        // Trigger receipt download if success (you can replace this with real download logic)
        if (isSuccess) {
          downloadReceipt(); // Call the function to download the receipt
        }
  
        // Refresh the page after a short delay to allow the feedback to be visible
        setTimeout(function() {
          location.reload(); // Refresh the page
        }, 2000); // Delay refresh by 2 seconds for feedback visibility
      }, 3000); // Simulate a 3-second delay for sending data
    }
  
    function downloadReceipt() {
      // This function simulates downloading the receipt
      // Create a dummy receipt as an example
      const receiptContent = "Receipt Data: \nItem 1: $10\nItem 2: $20\nTotal: $30";
      
      // Create a Blob from the receipt content
      const blob = new Blob([receiptContent], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "receipt.txt"; // Filename for the download
      
      // Trigger download
      link.click(); // This will download the file
    }
</script>

</script>  
<!-- Footer -->

<footer class="main-footer">
<p>&copy; 2025 Fh260. All rights reserved.</p>
<p>
    <a href="sign.html">Sign In</a> | 
    <a href="index.html">Back Page</a> | 
    <a href="admin.html">Admin</a>
</p>
</footer>
</footer>
</html>
